import{b as f,d as K,e as p,f as n,n as z,r as P,w as ie,o as he,t as x,g as Z,h as me,v as Ee,i as Le,j as Pe,k as X,l as ue,a as Ce,F as se,m as le,p as we,q as Te,s as Ne,u as V,x as $e,c as Ie}from"./vue.esm-bundler.js";import{g as Q,B as Me}from"./base-section.js";import{b as ke,c as be}from"./analytics-data.js";import{u as Ae,a as ve,b as Re}from"./use-focus-management.js";import{e as Y,w as ce}from"./shopify.js";import{c as De,m as S,g as ye,e as Oe,S as Fe}from"./swiper-core.js";import{N as Be}from"./navigation.js";import{P as ze}from"./pagination.js";import{c as pe}from"./classes-to-selector.js";import{b as re}from"./animations.js";import{T as Se,c as Ue,b as je,n as Ge,d as qe,e as xe}from"./rudderstack-client.js";import{g as Ve}from"./item-cart-properties.js";import{u as Ye}from"./use-scroll-lock.js";import{i as _e,a as Ke}from"./validator.js";import"./create-element-if-not-defined.js";import"./cookies.js";import"./use-viewport-size.js";function He(g){let{swiper:e,extendParams:o,on:c}=g;o({a11y:{enabled:!0,notificationClass:"swiper-notification",prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}",slideLabelMessage:"{{index}} / {{slidesLength}}",containerMessage:null,containerRoleDescriptionMessage:null,containerRole:null,itemRoleDescriptionMessage:null,slideRole:"group",id:null,scrollOnFocus:!0}}),e.a11y={clicked:!1};let v=null,E,C,$=new Date().getTime();function U(t){const a=v;a.length!==0&&(a.innerHTML="",a.innerHTML=t)}function D(t){const a=()=>Math.round(16*Math.random()).toString(16);return"x".repeat(t).replace(/x/g,a)}function j(t){t=S(t),t.forEach(a=>{a.setAttribute("tabIndex","0")})}function I(t){t=S(t),t.forEach(a=>{a.setAttribute("tabIndex","-1")})}function T(t,a){t=S(t),t.forEach(u=>{u.setAttribute("role",a)})}function _(t,a){t=S(t),t.forEach(u=>{u.setAttribute("aria-roledescription",a)})}function m(t,a){t=S(t),t.forEach(u=>{u.setAttribute("aria-controls",a)})}function w(t,a){t=S(t),t.forEach(u=>{u.setAttribute("aria-label",a)})}function J(t,a){t=S(t),t.forEach(u=>{u.setAttribute("id",a)})}function O(t,a){t=S(t),t.forEach(u=>{u.setAttribute("aria-live",a)})}function G(t){t=S(t),t.forEach(a=>{a.setAttribute("aria-disabled",!0)})}function q(t){t=S(t),t.forEach(a=>{a.setAttribute("aria-disabled",!1)})}function k(t){if(t.keyCode!==13&&t.keyCode!==32)return;const a=e.params.a11y,u=t.target;if(!(e.pagination&&e.pagination.el&&(u===e.pagination.el||e.pagination.el.contains(t.target))&&!t.target.matches(pe(e.params.pagination.bulletClass)))){if(e.navigation&&e.navigation.prevEl&&e.navigation.nextEl){const L=S(e.navigation.prevEl);S(e.navigation.nextEl).includes(u)&&(e.isEnd&&!e.params.loop||e.slideNext(),e.isEnd?U(a.lastSlideMessage):U(a.nextSlideMessage)),L.includes(u)&&(e.isBeginning&&!e.params.loop||e.slidePrev(),e.isBeginning?U(a.firstSlideMessage):U(a.prevSlideMessage))}e.pagination&&u.matches(pe(e.params.pagination.bulletClass))&&u.click()}}function M(){if(e.params.loop||e.params.rewind||!e.navigation)return;const{nextEl:t,prevEl:a}=e.navigation;a&&(e.isBeginning?(G(a),I(a)):(q(a),j(a))),t&&(e.isEnd?(G(t),I(t)):(q(t),j(t)))}function H(){return e.pagination&&e.pagination.bullets&&e.pagination.bullets.length}function ne(){return H()&&e.params.pagination.clickable}function oe(){const t=e.params.a11y;H()&&e.pagination.bullets.forEach(a=>{e.params.pagination.clickable&&(j(a),e.params.pagination.renderBullet||(T(a,"button"),w(a,t.paginationBulletMessage.replace(/\{\{index\}\}/,Oe(a)+1)))),a.matches(pe(e.params.pagination.bulletActiveClass))?a.setAttribute("aria-current","true"):a.removeAttribute("aria-current")})}const l=(t,a,u)=>{j(t),t.tagName!=="BUTTON"&&(T(t,"button"),t.addEventListener("keydown",k)),w(t,u),m(t,a)},h=t=>{C&&C!==t.target&&!C.contains(t.target)&&(E=!0),e.a11y.clicked=!0},r=()=>{E=!1,requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.destroyed||(e.a11y.clicked=!1)})})},b=t=>{$=new Date().getTime()},A=t=>{if(e.a11y.clicked||!e.params.a11y.scrollOnFocus||new Date().getTime()-$<100)return;const a=t.target.closest(`.${e.params.slideClass}, swiper-slide`);if(!a||!e.slides.includes(a))return;C=a;const u=e.slides.indexOf(a)===e.activeIndex,L=e.params.watchSlidesProgress&&e.visibleSlides&&e.visibleSlides.includes(a);u||L||t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||(e.isHorizontal()?e.el.scrollLeft=0:e.el.scrollTop=0,requestAnimationFrame(()=>{E||(e.params.loop?e.slideToLoop(parseInt(a.getAttribute("data-swiper-slide-index")),0):e.slideTo(e.slides.indexOf(a),0),E=!1)}))},W=()=>{const t=e.params.a11y;t.itemRoleDescriptionMessage&&_(e.slides,t.itemRoleDescriptionMessage),t.slideRole&&T(e.slides,t.slideRole);const a=e.slides.length;t.slideLabelMessage&&e.slides.forEach((u,L)=>{const R=e.params.loop?parseInt(u.getAttribute("data-swiper-slide-index"),10):L,i=t.slideLabelMessage.replace(/\{\{index\}\}/,R+1).replace(/\{\{slidesLength\}\}/,a);w(u,i)})},y=()=>{const t=e.params.a11y;e.el.append(v);const a=e.el;t.containerRoleDescriptionMessage&&_(a,t.containerRoleDescriptionMessage),t.containerMessage&&w(a,t.containerMessage),t.containerRole&&T(a,t.containerRole);const u=e.wrapperEl,L=t.id||u.getAttribute("id")||`swiper-wrapper-${D(16)}`,R=e.params.autoplay&&e.params.autoplay.enabled?"off":"polite";J(u,L),O(u,R),W();let{nextEl:i,prevEl:d}=e.navigation?e.navigation:{};i=S(i),d=S(d),i&&i.forEach(N=>l(N,L,t.nextSlideMessage)),d&&d.forEach(N=>l(N,L,t.prevSlideMessage)),ne()&&S(e.pagination.el).forEach(B=>{B.addEventListener("keydown",k)}),ye().addEventListener("visibilitychange",b),e.el.addEventListener("focus",A,!0),e.el.addEventListener("focus",A,!0),e.el.addEventListener("pointerdown",h,!0),e.el.addEventListener("pointerup",r,!0)};function F(){v&&v.remove();let{nextEl:t,prevEl:a}=e.navigation?e.navigation:{};t=S(t),a=S(a),t&&t.forEach(L=>L.removeEventListener("keydown",k)),a&&a.forEach(L=>L.removeEventListener("keydown",k)),ne()&&S(e.pagination.el).forEach(R=>{R.removeEventListener("keydown",k)}),ye().removeEventListener("visibilitychange",b),e.el&&typeof e.el!="string"&&(e.el.removeEventListener("focus",A,!0),e.el.removeEventListener("pointerdown",h,!0),e.el.removeEventListener("pointerup",r,!0))}c("beforeInit",()=>{v=De("span",e.params.a11y.notificationClass),v.setAttribute("aria-live","assertive"),v.setAttribute("aria-atomic","true")}),c("afterInit",()=>{e.params.a11y.enabled&&y()}),c("slidesLengthChange snapGridLengthChange slidesGridLengthChange",()=>{e.params.a11y.enabled&&W()}),c("fromEdge toEdge afterInit lock unlock",()=>{e.params.a11y.enabled&&M()}),c("paginationUpdate",()=>{e.params.a11y.enabled&&oe()}),c("destroy",()=>{e.params.a11y.enabled&&F()})}const te={__name:"icon-svg",props:{className:{default:"",type:String},name:{required:!0,type:String}},setup(g){return(e,o)=>g.name==="close"?(p(),f("svg",{key:0,class:z(g.className),fill:"none",viewBox:"0 0 24 24"},o[0]||(o[0]=[n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.31539 6.89807C8.12013 6.7028 7.80354 6.7028 7.60828 6.89807C7.41302 7.09333 7.41302 7.40991 7.60828 7.60517L11.7104 11.7073L7.31557 16.1021C7.12031 16.2974 7.12031 16.614 7.31557 16.8092C7.51083 17.0045 7.82742 17.0045 8.02268 16.8092L12.4175 12.4144L16.8007 16.7976C16.9959 16.9928 17.3125 16.9928 17.5078 16.7976C17.703 16.6023 17.703 16.2857 17.5078 16.0905L13.1246 11.7073L17.2151 7.61684C17.4103 7.42157 17.4103 7.10499 17.2151 6.90973C17.0198 6.71447 16.7032 6.71447 16.508 6.90973L12.4175 11.0002L8.31539 6.89807Z",fill:"currentColor"},null,-1)]),2)):g.name==="chevron-down"?(p(),f("svg",{key:1,class:z(g.className),fill:"none",viewBox:"0 0 24 24"},o[1]||(o[1]=[n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16.5889 9.64643C16.7842 9.84169 16.7842 10.1583 16.5889 10.3535L12.3463 14.5962C12.151 14.7914 11.8344 14.7914 11.6392 14.5962L7.39652 10.3535C7.20125 10.1583 7.20125 9.84169 7.39652 9.64643C7.59178 9.45117 7.90836 9.45117 8.10362 9.64643L11.9927 13.5355L15.8818 9.64643C16.0771 9.45117 16.3936 9.45117 16.5889 9.64643Z",fill:"currentColor"},null,-1)]),2)):g.name==="chevron-left"?(p(),f("svg",{key:2,class:z(g.className),fill:"none",viewBox:"0 0 24 24"},o[2]||(o[2]=[n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.0962 16.7175C13.901 16.9128 13.5844 16.9128 13.3891 16.7175L9.14648 12.4749C8.95122 12.2796 8.95122 11.963 9.14648 11.7678L13.3891 7.52512C13.5844 7.32986 13.901 7.32986 14.0962 7.52512C14.2915 7.72038 14.2915 8.03696 14.0962 8.23222L10.2071 12.1213L14.0962 16.0104C14.2915 16.2057 14.2915 16.5222 14.0962 16.7175Z",fill:"currentColor"},null,-1)]),2)):g.name==="chevron-right"?(p(),f("svg",{key:3,class:z(g.className),fill:"none",viewBox:"0 0 24 24"},o[3]||(o[3]=[n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10.1464 7.52512C10.3417 7.32986 10.6583 7.32986 10.8536 7.52512L15.0962 11.7678C15.2915 11.963 15.2915 12.2796 15.0962 12.4749L10.8536 16.7175C10.6583 16.9128 10.3417 16.9128 10.1464 16.7175C9.95118 16.5222 9.95118 16.2057 10.1464 16.0104L14.0355 12.1213L10.1464 8.23223C9.95118 8.03697 9.95118 7.72039 10.1464 7.52512Z",fill:"currentColor"},null,-1)]),2)):g.name==="chevron-up"?(p(),f("svg",{key:4,class:z(g.className),fill:"none",viewBox:"0 0 24 24"},o[4]||(o[4]=[n("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.39645 14.5962C7.20118 14.4009 7.20118 14.0843 7.39645 13.8891L11.6391 9.64644C11.8343 9.45117 12.1509 9.45117 12.3462 9.64644L16.5888 13.8891C16.7841 14.0843 16.7841 14.4009 16.5888 14.5962C16.3936 14.7914 16.077 14.7914 15.8817 14.5962L11.9926 10.7071L8.10355 14.5962C7.90829 14.7914 7.59171 14.7914 7.39645 14.5962Z",fill:"currentColor"},null,-1)]),2)):K("",!0)}},We={key:0,class:"bg-natural-white-60 absolute inset-0"},Ze={class:"Drawer__header m-2.5 flex h-22 items-center"},Je=["textContent"],Xe={class:"flex h-[calc(100%-108px)] flex-col px-2 sm:px-15"},Qe={class:"flex flex-col gap-8"},et={class:"flex flex-col gap-2"},tt=["textContent"],nt={class:"rounded-xl bg-white p-6"},at={class:"flex items-center gap-3"},st=["checked"],lt={class:"mt-auto mb-3 flex justify-end gap-2"},ot=["disabled"],rt={key:1,class:"bg-natural-white sans-serif flex w-full items-center justify-center py-2 text-xs font-medium"},it=["textContent"],fe=160,ct={__name:"cart-gift-note",props:{giftNoteLabel:{default:"",type:String},giftNoteTitle:{default:"",type:String}},setup(g){const e=g,o=P(""),c=P(!1),v=P(!1),E=Ae(),{addAttributes:C,cart:$}=ve(),U=()=>{c.value=!0},D=()=>o.value.length<=fe;ie(E.isOpen,_=>{_||(c.value=!1)});const j=()=>{c.value=!1},I=async()=>{try{await C({gift_message:o.value,logo_free:v.value})}catch(_){Y("[Allbirds component] - Cart Gift Note - handleSaveGiftNote - Error saving gift note",{error:_})}c.value=!1},T=()=>{c.value=!1};return he(async()=>{var _;if((_=$?.value)!=null&&_.attributes){const{gift_message:m,logo_free:w}=$.value.attributes;o.value=m||"",v.value=w||!1}}),(_,m)=>c.value?(p(),f("div",We,[n("div",Ze,[n("h3",{class:"m-auto text-xl",textContent:x(g.giftNoteTitle)},null,8,Je),n("button",{"aria-label":"Close Gift Note",class:"mb-auto hover:cursor-pointer",onClick:j},[Z(te,{name:"close","class-name":"size-8"})])]),n("div",Xe,[n("div",Qe,[n("div",et,[m[3]||(m[3]=n("label",{for:"gift-note",class:"text-normal font-medium uppercase"}," Gift Message (Optional) ",-1)),me(n("textarea",{id:"gift-note","onUpdate:modelValue":m[0]||(m[0]=w=>o.value=w),rows:"5",maxlength:"160",placeholder:"Type your message here, but avoid emojis and special characters.",class:"w-full rounded-xl bg-white px-5 py-2"},null,512),[[Ee,o.value]]),n("div",{class:z(["font-light-charcoal flex gap-1 text-sm",{"text-red-500":fe-o.value.length===0}])},[n("span",{textContent:x(fe-o.value.length)},null,8,tt),m[2]||(m[2]=Le(" Characters Remaining "))],2)]),n("div",nt,[m[5]||(m[5]=n("p",{class:"text-normal mb-3 font-medium uppercase"},"Logo-Free Packaging",-1)),n("div",at,[me(n("input",{id:"logos-free","onUpdate:modelValue":m[1]||(m[1]=w=>v.value=w),type:"checkbox","aria-label":"Hide the logos on the box. ",checked:v.value,class:"checkbox my-auto"},null,8,st),[[Pe,v.value]]),m[4]||(m[4]=n("label",{for:"logos-free",class:"text-light-charcoal max-w-80 text-sm"}," Let\u2019s keep it a surprise. Hide the logos on the box. ",-1))])])]),n("div",lt,[n("button",{class:"btn btn btn-secondary w-full hover:border-black",disabled:!D(),onClick:I}," Save ",8,ot),n("button",{class:"btn btn-secondary w-full hover:border-black",onClick:T}," Cancel ")])])])):(p(),f("div",rt,[n("button",{"aria-label":"Open Gift Note",class:"flex gap-1 px-2 py-1 text-xs font-medium hover:cursor-pointer",onClick:U},[n("span",{textContent:x(e.giftNoteLabel)},null,8,it),m[6]||(m[6]=n("span",null,"+",-1))])]))}},ee=g=>{const e=typeof Shopify<"u"&&Shopify.currency?Shopify.currency.active:"USD",o=typeof Shopify<"u"&&Shopify.locale?Shopify.locale:"en-US",c=Number.isInteger(g),v=c?g:Math.round(g*100),E=c?g/100:g;if(typeof Shopify<"u"&&Shopify.formatMoney)try{return Shopify.formatMoney(v,"${{amount_no_decimals}}")}catch{}try{return new Intl.NumberFormat(o,{currency:e,maximumFractionDigits:0,minimumFractionDigits:0,style:"currency"}).format(E)}catch(C){return Y("[Allbirds utils] - formatCurrency - Error formatting currency with Intl.NumberFormat:",{amount:g,shopifyCurrency:e,shopifyLocale:o},C),`${e} ${Math.round(E)}`}},dt=["textContent"],ut={class:"flex items-center justify-center rounded-full border border-black text-xs font-medium uppercase"},pt={class:"swiper-wrapper"},ft=["href"],gt=["src","alt"],mt={class:"w-[70%]"},ht={class:"mb-2.5 flex items-center justify-between"},vt=["href","textContent"],bt={key:0,class:"flex items-center gap-x-1"},yt=["textContent"],xt=["textContent"],_t=["textContent"],Ct={class:"mb-2.5 flex gap-x-2"},wt=["aria-label","onClick"],kt={class:"flex"},At={class:"relative w-full min-w-[165px]"},St=["for"],Et=["id","onUpdate:modelValue"],Lt=["value","disabled","textContent"],Pt=["onClick","textContent"],Tt={class:"cart-upsells-navigation justify-right hidden w-fit gap-x-2 md:mt-2 md:ml-auto md:flex","aria-label":"Upsell navigation"},Nt=7,$t={__name:"cart-upsells",props:{addButtonText:{default:"Add+",type:String},recommendations:{default:()=>[],type:Array},sizeLabel:{default:"Size:",type:String},title:{default:"Recommended for you",type:String},upsellsAddLabel:{default:"Add+",type:String}},setup(g){const e=g,o={breakpoints:{768:{navigation:{enabled:!0},pagination:{enabled:!1},slidesPerView:1.5}},centeredSlides:!1,modules:[ze,Be,He],navigation:{enabled:!1,nextEl:".cart-upsells-next-button",prevEl:".cart-upsells-prev-button"},pagination:{clickable:!0,el:".swiper-pagination",enabled:!0},slidesPerView:1,spaceBetween:8},{addSingleVariant:c,cart:v}=ve(),E=P(null),C=P(null),$=P(null),U=P(null),D=P(null),j=P(null),I=P(!0),T=P({});let _=null,m=null;const w=()=>{E.value&&U.value&&D.value&&$.value&&O.value.length>0&&(_=new Fe(E.value,{...o}))},J=()=>{_&&(_.destroy(!0,!0),_=null)},O=X(()=>{var l,h;try{if(!e.recommendations)return[];const r=e.recommendations||[];if(Array.isArray(r)&&r.length===0)return ce("[Allbirds component] - Cart Upsells - processedRecommendations - No recommendations provided",{propsRecommendations:r}),[];const b=r.reduce((y,F)=>{const t=F.filter(a=>!!a.colorName);return t.length===0?y:[...y,t]},[]),A=(h=(l=v.value)==null?void 0:l.items)==null?void 0:h.reduce((y,F)=>{const t=F.properties._master_name||"unknown";return{...y,[t]:y[t]?y[t]+F.quantity:F.quantity}},{});return b.filter(y=>!A[y[0].productName]).map(y=>{var R,i;if(!Array.isArray(y)||y.length===0)return null;const F=y.filter(d=>!!d.colorName),t=y[0].productId;T.value[t]||(T.value[t]=y[0].handle);const a=T.value[t],u=y.find(d=>d.handle===a)||y[0];return{...y[0],allColorVariants:F,cfId:u.cfId,collectionProductCardImage:u.collectionProductCardImage,colorName:u.colorName,handle:u.handle,image:u.image,name:u.name,selected_variant_id:((i=(R=u.sizes)==null?void 0:R.find(d=>d.isAvailable))==null?void 0:i.legacyResourceId)||"",selectedColor:a,sizes:u.sizes,swatchColors:y.flatMap(({handle:d,swatchColors:s})=>({handle:d,hues:s})).slice(0,Nt)}}).filter(y=>y!==null)}catch(r){return ce("[Allbirds component] - Cart Upsells - processedRecommendations - Error processing recommendations",{error:r}),[]}});he(async()=>{O.value.length>0&&w(),await ue(),k()}),Ce(()=>{J()});const G=l=>l?`/products/${l}`:"#",q=(l,h="price")=>{if(l&&l.length>0){const r=l.find(b=>b.isAvailable);if(r&&r[h]){const b=parseFloat(r[h])*100;return ee(b)}if(l[0]&&l[0][h]){const b=parseFloat(l[0][h])*100;return ee(b)}}return""},k=()=>{if(!C.value)return;m&&m.kill();const l=C.value,h=l.scrollHeight;Q.set(l,{maxHeight:I.value?`${h}px`:"0px"}),m=Q.timeline({paused:!0}),m.fromTo(l,{maxHeight:"0px"},{duration:.3,ease:re.POWER3_OUT,maxHeight:`${h}px`},0),m.fromTo(j.value,{y:"0px"},{duration:.3,ease:re.POWER3_OUT,y:0},0),I.value?m.progress(1,!1):m.progress(0,!1)},M=(l,h)=>{T.value[l.productId]=h},H=async l=>{var b;if(!(l!=null&&l.selected_variant_id)||l?.selected_variant_id===""){Y("[Allbirds component] - Cart Upsells - handleAddItem - No size selected",{item:l},new Error("No size selected"));return}const h=Number(l.selected_variant_id),r=Ve({colorName:l.colorName,compareAtPrice:l.compareAtPrice,masterName:l.productName});try{await c(h,1,r);const A=(b=v?.value)==null?void 0:b.items.find(W=>W.id===h);ke(v.value,A,Se.UPSELL,A?.variant_title)}catch(A){Y("[Allbirds component] - Cart Upsells - handleAddItem - Error adding item",{cleanId:h,item:l},A)}},ne=()=>{I.value=!I.value},oe=l=>!Array.isArray(l)||l.length===0?"background: transparent":l.length===3?`background: linear-gradient(to right, ${l[0]} 33%, ${l[1]} 33%, ${l[1]} 66%, ${l[2]} 66%)`:l.length===2?`background: linear-gradient(135deg, ${l[0]} 50%, ${l[1]} 50%)`:`background: ${l[0]}`;return ie(O,async(l,h)=>{let r=0;_&&_.activeIndex!==void 0&&(r=_.activeIndex),J(),l.length>0&&(await ue(),w(),_&&r>0&&r<l.length&&_.slideTo(r,0)),await ue(),k()},{deep:!0}),ie(I,l=>{!m&&(k(),!m)||(l?m.play():m.reverse())}),(l,h)=>O.value.length>0?(p(),f("div",{key:0,ref_key:"mainContainer",ref:j,class:z(["cart-upsells bg-natural-white-60 overflow-hidden p-2.5",I.value?"pb-8":"pb-2"])},[n("button",{class:"flex w-full cursor-pointer items-center justify-between",onClick:h[0]||(h[0]=r=>ne())},[n("h3",{class:"font-regular text-xs tracking-wider uppercase",textContent:x(g.title)},null,8,dt),n("span",ut,[Z(te,{class:z(I.value?"rotate-180":""),name:"chevron-up","class-name":"size-5 transform-origin-center transition-transform ease-in-out duration-300"},null,8,["class"])])]),n("div",{ref_key:"upsellsContainer",ref:C,class:"relative translate-y-2.5 overflow-visible"},[n("div",{ref_key:"swiperContainer",ref:E,class:"swiper !overflow-visible md:mb-2.5"},[n("div",pt,[(p(!0),f(se,null,le(O.value,r=>(p(),f("div",{key:r.cfId,class:"swiper-slide !flex h-auto items-center justify-between rounded-[10px] border border-gray-200 bg-white px-2.5 py-4"},[n("a",{href:G(r.handle),class:"mb-2 block w-fit"},[n("img",{src:r.image,alt:r.productName,class:"aspect-square size-20 rounded object-contain"},null,8,gt)],8,ft),n("div",mt,[n("div",ht,[n("a",{class:"font-regular text-light-charcoal text-sm text-nowrap",href:G(r.handle),textContent:x(r.productName)},null,8,vt),q(r.sizes,"compareAtPrice")?(p(),f("div",bt,[n("p",{class:"text-red text-sm font-medium",textContent:x(q(r.sizes,"price"))},null,8,yt),n("p",{class:"text-light-charcoal text-sm font-medium line-through",textContent:x(q(r.sizes,"compareAtPrice"))},null,8,xt)])):(p(),f("p",{key:1,class:"text-sm font-medium",textContent:x(q(r.sizes,"price"))},null,8,_t))]),n("div",null,[n("div",Ct,[(p(!0),f(se,null,le(r.swatchColors,(b,A)=>(p(),f("button",{key:A,class:z(["h-5 w-5 cursor-pointer rounded-full border",[r.handle===b.handle?"border border-black":"border-transparent"]]),"aria-label":`Handle ${b.handle}`,onClick:W=>M(r,b.handle)},[n("div",{style:we(oe(b.hues)),class:"m-auto size-[14px] rounded-full"},null,4)],10,wt))),128))]),n("div",kt,[n("div",At,[n("label",{for:`size-select-${r.cfId}`,class:"pointer-events-none absolute top-1/2 right-2 -translate-y-1/2 rounded border border-black"},[h[1]||(h[1]=n("span",{class:"sr-only"},"Select size",-1)),Z(te,{name:"chevron-down","class-name":"size-4 pointer-events-none"})],8,St),r.sizes&&r.sizes.length>0?me((p(),f("select",{key:0,id:`size-select-${r.cfId}`,"onUpdate:modelValue":b=>r.selected_variant_id=b,class:"border-back w-full min-w-[100px] appearance-none rounded border p-2 text-xs","aria-label":"Select size"},[h[2]||(h[2]=n("option",{value:"Select Size",disabled:""},null,-1)),(p(!0),f(se,null,le(r.sizes,b=>(p(),f("option",{key:b.legacyResourceId,class:"text-xs",value:b.legacyResourceId,disabled:!b.isAvailable,textContent:x(`${e.sizeLabel} ${b.title}`)},null,8,Lt))),128))],8,Et)),[[Te,r.selected_variant_id]]):K("",!0)]),n("button",{class:"w-full cursor-pointer text-sm font-medium underline md:no-underline md:hover:underline",onClick:b=>H(r),textContent:x(e.upsellsAddLabel)},null,8,Pt)])])])]))),128))]),n("div",Tt,[n("button",{ref_key:"prevButton",ref:U,class:"cart-upsells-prev-button cursor-pointer rounded-full border border-black","aria-label":"Previous upsell item"},[Z(te,{name:"chevron-left","class-name":"size-5 text-neutral-900"})],512),n("button",{ref_key:"nextButton",ref:D,class:"cart-upsells-next-button cursor-pointer rounded-full border border-black","aria-label":"Next upsell item"},[Z(te,{name:"chevron-right","class-name":"size-5 text-neutral-900"})],512)]),n("div",{ref_key:"paginationContainer",ref:$,class:"swiper-pagination cart-upsells-pagination flex justify-center md:hidden","aria-label":"Slider pagination"},null,512)],512)],512)],2)):K("",!0)}},ae={AMAZON_PAY:"amazonpay",ANDROID_PAY:"androidpay",APPLE_PAY:"apple pay",GOOGLE_PAY:"gpay",PAY_PAL:"paypal",SHOPIFY_PAY:"shopay"},ge={amazon_pay:{altText:"Proceed with Amazon Pay",analyticsKey:ae.AMAZON_PAY,backgroundColor:"#fad676",isApplePay:!1,isApplePayFriendly:!1,logo:"https://images.ctfassets.net/9uo1qvvet3xa/33RudJxATBd104HGRLDee7/b2c410059d5ba3cdef8fcbd4f8a5803c/Amazon_Pay_-_Black.svg"},android_pay:{altText:"Proceed with Android Pay",analyticsKey:ae.ANDROID_PAY,backgroundColor:"",isApplePay:!1,isApplePayFriendly:!1,logo:""},apple_pay:{altText:"Proceed with Apple Pay",analyticsKey:ae.APPLE_PAY,backgroundColor:"#000000",isApplePay:!0,isApplePayFriendly:!0,logo:"https://images.ctfassets.net/9uo1qvvet3xa/3DDS5hjUEljoau9dxGTHsz/aac3b6efbcbecdfb9c472304e5efa073/Apple_Pay_-_White.svg"},google_pay:{altText:"Proceed with Google Pay",analyticsKey:ae.GOOGLE_PAY,backgroundColor:"#000000",isApplePay:!1,isApplePayFriendly:!1,logo:"https://images.ctfassets.net/9uo1qvvet3xa/4mz6vy0p8adMSUKkW5qd7p/416938c3e395f691553ab47f0007f8b6/G_Pay.png"},paypal:{altText:"Proceed with PayPal",analyticsKey:ae.PAY_PAL,backgroundColor:"#ffc439",isApplePay:!1,isApplePayFriendly:!0,logo:"https://images.ctfassets.net/9uo1qvvet3xa/4dooJgkFpDR0AeMb4MKw8u/954fd7930cbc82523b57ef6e724be215/PayPal_-_Color.svg"},shopify_pay:{altText:"Proceed with Shop Pay",analyticsKey:ae.SHOPIFY_PAY,backgroundColor:"#5a31f4",isApplePay:!1,isApplePayFriendly:!0,logo:"https://images.ctfassets.net/9uo1qvvet3xa/6z90ekdLBJdFRPh7vo2wLh/2d4a0a4e96f3d7a19cea75f09cdc59ad/ShopPay_-_White.svg"}},It=(g,e)=>typeof g!="string"?(ce("[Allbirds utils] - substitute - template is not a string",{template:g,values:e},new Error("template is not a string")),""):typeof e!="object"||e===null?(ce("[Allbirds utils] - substitute - values is not an object",{values:e},new Error("values is not an object")),g):g.replace(/{(\w+)}/g,(o,c)=>Object.prototype.hasOwnProperty.call(e,c)?e[c]:o),Mt={class:"flex flex-col items-center justify-between px-2.5 py-2.5"},Rt={class:"flex w-full items-center justify-between"},Dt=["textContent"],Ot=["textContent"],Ft=["textContent"],Bt={key:0,class:"w-full py-3"},zt={class:"bg-natural-white h-[7px] w-full rounded-[4px]"},Ut={class:"mb-auto overflow-y-auto px-2.5"},jt={class:"flex w-full items-center"},Gt=["href"],qt=["src","alt"],Vt={class:"flex grow-1 flex-col gap-y-2.5"},Yt={class:"flex items-center justify-between"},Kt=["href","textContent"],Ht=["textContent"],Wt=["textContent"],Zt={class:"flex items-center justify-between"},Jt={class:"border-stroke flex min-h-[32px] min-w-[100px] items-center justify-around rounded-[20px] border text-xs font-medium text-black"},Xt=["onClick"],Qt=["textContent"],en=["disabled","onClick"],tn={class:"flex h-[112px] flex-col items-end gap-y-1"},nn={key:0,class:"flex gap-x-2 text-sm font-medium"},an=["textContent"],sn=["textContent"],ln=["textContent"],on={key:2,"aria-label":"Final Sale",class:"text-red block text-xs"},rn=["onClick"],cn={class:"border-light-charcoal-0.3 border-t bg-white px-2.5 py-3.5"},dn={class:"mb-2 flex items-center justify-between font-semibold"},un=["textContent"],pn=["textContent"],fn=["textContent"],gn={key:1,class:"mb-3.5 overflow-hidden px-2.5"},mn={class:"flex justify-between gap-2"},hn=["onClick"],vn=["src","alt"],bn=["textContent"],yn={class:"flex w-full flex-col items-center gap-y-5"},xn=["onClick","textContent"],_n={__name:"cart-drawer",props:{addButtonText:{default:"Add+",type:String},checkoutButtonLabel:{default:"Checkout",type:String},colorLabel:{default:"Color:",type:String},emptyCartLinks:{default:()=>[],type:Array},emptyCartTitle:{default:"Your cart is empty. Start shopping!",type:String},enabledPaymentTypes:{default:()=>[],type:Array},freeShippingMessageAchieved:{default:"You've earned free shipping!",type:String},freeShippingMessageNotAchieved:{default:"Spend {amount} more to earn free shipping!",type:String},freeShippingThreshold:{default:7500,type:Number},giftNoteEnabled:{default:!1,type:Boolean},giftNoteLabel:{default:"",type:String},giftNoteTitle:{default:"",type:String},openCartDrawer:{default:!1,type:Boolean},showFreeShippingThreshold:{default:!0,type:Boolean},sizeLabel:{default:"Size:",type:String},subtotalLabel:{default:"Subtotal",type:String},title:{default:"Cart",type:String},upsellProducts:{default:()=>[],type:Array},upsellsAddLabel:{default:"Add+",type:String}},setup(g){const e=g,{cart:o,getCart:c,isLoading:v,removeLineItem:E,updateSingleLineItem:C}=ve(),{lockScroll:$,unlockScroll:U}=Ye(),D=Ae(),j=e.upsellProducts,I=X(()=>{var i;return`${e.title} (${((i=o.value)==null?void 0:i.item_count)||0})`}),T=X(()=>{var i;return((i=o.value)==null?void 0:i.total_price)||0}),_=X(()=>Math.max(0,e.freeShippingThreshold-T.value)),m=X(()=>ee(_.value)),w=X(()=>e.freeShippingThreshold===0?1:Math.min(1,T.value/e.freeShippingThreshold)),J=X(()=>T.value>=e.freeShippingThreshold?e.freeShippingMessageAchieved:_.value>0?It(e.freeShippingMessageNotAchieved,{amount:m.value}):""),O=P(null),G=P(null),q=P(null);let k=null,M=null;const H=P([]);Re({containerRef:G,focusFirstOnActivate:P(!0),isActive:D.isOpen,trapFocus:!0});const ne=()=>{O.value&&(k&&(k.kill(),k.clear(),k=null),k=Q.timeline({paused:!0}))},oe=()=>{const i=je();H.value=e.enabledPaymentTypes.map(d=>ge[d]?{...ge[d],name:d}:null).filter(d=>d!==null&&(i?d.isApplePayFriendly===i:!d.isApplePay))},l=()=>{G.value&&(M&&(M.kill(),M.clear(),M=null),M=Q.timeline({onComplete:()=>{v.value||A(w.value)},onReverseComplete:()=>{U()},paused:!0}),Q.set(q.value,{opacity:0,pointerEvents:"none"}),Q.set(G.value,{xPercent:100}),M.to(q.value,{duration:.4,ease:re.SINE_OUT,opacity:1,pointerEvents:"auto"},0),M.to(G.value,{duration:.8,ease:re.POWER3_OUT,xPercent:0},0))},h=i=>{i.key==="Escape"&&R()},r=()=>{window.addEventListener("keydown",h)},b=()=>{window.removeEventListener("keydown",h)},A=i=>{k&&(k.to(O.value,{duration:.6,ease:re.POWER3_IN_OUT,scaleX:i,transformOrigin:"left"}),k.play())},W=()=>{M&&D.isOpen.value&&M.play()},y=async i=>{var N;const d=(N=o?.value)==null?void 0:N.items.find(B=>B.id===i),s=d?.quantity;try{await E(i),be(o.value,d,s)}catch(B){Y("[Allbirds component] - Cart Drawer - handleRemoveItem - Error removing item",{currentQuantity:s,productRemoved:d},B)}},F=async(i,d,s)=>{var N;if(_e(i)||_e(d)||!Ke(s)){Y("[Allbirds component] - Cart Drawer - handleUpdateQuantity - No lineId or newQuantity or isAdding",{isAdding:s,lineId:i,newQuantity:d},new Error("No lineId or newQuantity or isAdding"));return}if(d<=0)await y(i);else{const B=(N=o?.value)==null?void 0:N.items.find(de=>de.id===i);try{await C(i,d),s?ke(o.value,B,Se.CART,B?.variant_title):be(o.value,B,d)}catch(de){Y("[Allbirds component] - Cart Drawer - handleUpdateQuantity - Error updating quantity",{isAdding:s,newQuantity:d,productToUpdate:B},de)}}A(w.value)},t=()=>window.Shopify.routes.root+"checkout",a=()=>{window.location.href=t()},u=i=>{i?Ge({analyticsFn:()=>qe({location:xe.LOCATIONS.CART,name:ge[i].analyticsKey,type:xe.TYPES.BUTTON,url:t()}),openInNewTab:!1,urlToNavigate:t()}):Y("[Allbirds component] - Cart Drawer - handlePaymentMethodClick - No payment method name provided",{paymentMethodName:i},new Error("No payment method name"))},L=i=>{R(),i&&(window.location.href=i)},R=()=>{D.closeDrawer(),M.reverse()};return ie(v,i=>{!i&&o.value&&A(w.value)}),ie(D.isOpen,i=>{var d;i&&($(),ne(),W(),Ue({ajaxCartItems:(d=o?.value)==null?void 0:d.items}))}),he(async()=>{if(l(),r(),oe(),!o.value&&!v.value)try{await c()}catch(i){Y("[Allbirds component] - Cart Drawer - onMounted - Error getting cart",{cart:o},i)}Q.set(O.value,{scaleX:w.value,transformOrigin:"left"}),e.openCartDrawer&&D.openDrawer()}),Ce(()=>{b()}),(i,d)=>(p(),f("div",null,[n("div",{ref_key:"cartDrawerOverlay",ref:q,class:"z-takeover fixed inset-0 bg-black/50",onClick:d[0]||(d[0]=Ne(s=>R(),["self"]))},null,512),n("div",{ref_key:"cartDrawer",ref:G,class:"z-takeover fixed top-0 right-0 flex h-full w-full max-w-[531px] flex-col overflow-y-auto bg-white shadow-xl"},[n("div",Mt,[n("div",Rt,[n("h2",{class:"text-xs font-medium uppercase",textContent:x(I.value)},null,8,Dt),n("p",{class:"text-light-charcoal hidden text-center text-sm md:block",textContent:x(J.value)},null,8,Ot),n("button",{class:"ml-auto cursor-pointer md:ml-0","aria-label":"Close cart",onClick:d[1]||(d[1]=s=>R())},[Z(te,{name:"close","class-name":"size-8"})])]),n("p",{class:"text-light-charcoal text-center text-xs md:hidden",textContent:x(J.value)},null,8,Ft),e.showFreeShippingThreshold?(p(),f("div",Bt,[n("div",zt,[n("div",{ref_key:"freeShippingThresholdBar",ref:O,class:"h-[7px] w-full rounded-[4px] bg-black"},null,512)])])):K("",!0)]),V(o)&&V(o).item_count>0?(p(),f("div",{key:0,class:z(["flex h-full flex-col justify-between overflow-hidden",{"pointer-events-none opacity-80":V(v)}])},[n("ul",Ut,[(p(!0),f(se,null,le(V(o).items,s=>(p(),f("li",{key:s.id,class:"border-light-charcoal-0.3 mb-4 flex items-center justify-between border-b pb-4"},[n("div",jt,[n("a",{class:"block",href:s.url},[n("img",{src:s.image,alt:s.product_title,class:"mr-4 aspect-square size-[106px] rounded object-contain"},null,8,qt)],8,Gt),n("div",Vt,[n("div",Yt,[n("a",{class:"text-xs font-medium uppercase",href:s.url,"aria-label":"View product",textContent:x(s.properties&&s.properties._master_name?s.properties._master_name:s.product_title)},null,8,Kt)]),s.properties._color_name?(p(),f("p",{key:0,class:"font-regular text-light-charcoal text-xs",textContent:x(`${e.colorLabel} ${s.properties._color_name}`)},null,8,Ht)):K("",!0),s.variant_title&&s.variant_title!=="Default Title"?(p(),f("p",{key:1,class:"text-light-charcoal text-xs",textContent:x(`${e.sizeLabel} ${s.variant_title}`)},null,8,Wt)):K("",!0),n("div",Zt,[n("div",Jt,[n("button",{class:"cursor-pointer p-2","aria-label":"Decrease quantity",onClick:N=>F(s.id,s.quantity-1,!1)}," - ",8,Xt),n("span",{class:"",textContent:x(s.quantity)},null,8,Qt),n("button",{class:z(["cursor-pointer p-2",{"pointer-events-none opacity-50":s.quantity>=10}]),"aria-label":"Increase quantity",disabled:s.quantity>=10,onClick:N=>F(s.id,s.quantity+1,!0)}," + ",10,en)])])]),n("div",tn,[s.original_price>s.final_price||s.properties._compare_at_price?(p(),f("div",nn,[n("p",{class:"text-red",textContent:x(V(ee)(s.final_price))},null,8,an),n("p",{class:"text-light-charcoal line-through",textContent:x(V(ee)(s.properties._compare_at_price||s.original_price))},null,8,sn)])):(p(),f("p",{key:1,class:"block text-sm font-medium",textContent:x(V(ee)(s.final_price))},null,8,ln)),s.properties._is_final_sale?(p(),f("p",on," Final Sale ")):K("",!0),n("button",{"aria-label":"Remove item",title:"Remove item",class:"mt-auto block cursor-pointer",onClick:N=>y(s.id)},[Z(te,{name:"close","class-name":"size-8"})],8,rn)])])]))),128))]),Z($t,{recommendations:V(j),"size-label":e.sizeLabel,"upsells-add-label":e.upsellsAddLabel},null,8,["recommendations","size-label","upsells-add-label"]),e.giftNoteEnabled?(p(),$e(ct,{key:0,"gift-note-label":e.giftNoteLabel,"gift-note-title":e.giftNoteTitle},null,8,["gift-note-label","gift-note-title"])):K("",!0),n("div",cn,[n("div",dn,[n("p",{textContent:x(e.subtotalLabel)},null,8,un),n("p",{textContent:x(V(ee)(V(o).total_price))},null,8,pn)]),n("button",{class:"btn btn-secondary w-full hover:border-black",onClick:a,textContent:x(e.checkoutButtonLabel)},null,8,fn)]),H.value.length>0?(p(),f("div",gn,[n("ul",mn,[(p(!0),f(se,null,le(H.value,s=>(p(),f("li",{key:s.name,class:"w-full"},[n("a",{class:"btn w-full hover:border-black",style:we({backgroundColor:s.backgroundColor}),role:"button",onClick:N=>u(s.name)},[n("img",{src:s.logo,alt:s.altText||s.name,class:"h-4 w-full rounded object-contain px-5"},null,8,vn)],12,hn)]))),128))])])):K("",!0)],2)):(p(),f("div",{key:1,class:z(["mt-14 px-14 text-center",{"pointer-events-none opacity-80":V(v)}])},[n("p",{class:"mb-10 px-5 text-center text-xl md:px-10",textContent:x(e.emptyCartTitle)},null,8,bn),n("ul",yn,[(p(!0),f(se,null,le(e.emptyCartLinks,s=>(p(),f("li",{key:s.link_url,class:"w-full"},[(p(),f("button",{key:s.link_url,class:"btn btn-secondary w-full hover:border-black",onClick:N=>L(s.link_url),textContent:x(s.link_text)},null,8,xn))]))),128))])],2))],512)]))}};class Cn extends Me{constructor(){super('[data-section-type="cart-drawer-section"]')}init(e){const o=e.container,c=o.dataset,E=new URLSearchParams(window.location.search).get("openCartDrawer"),C={addButtonText:c.addButtonText,checkoutButtonLabel:c.checkoutButtonLabel,colorLabel:c.colorLabel,emptyCartLinks:JSON.parse(c.emptyCartLinks||"[]"),emptyCartTitle:c.emptyCartTitle,enabledPaymentTypes:JSON.parse(c.enabledPaymentTypes||"[]"),freeShippingMessageAchieved:c.freeShippingMessageAchieved,freeShippingMessageNotAchieved:c.freeShippingMessageNotAchieved,freeShippingThreshold:parseInt(c.freeShippingThreshold,10)||7500,giftNoteEnabled:c.giftNoteEnabled==="true",giftNoteLabel:c.giftNoteLabel,giftNoteTitle:c.giftNoteTitle,openCartDrawer:E==="true",showFreeShippingThreshold:c.showFreeShippingThreshold==="true",sizeLabel:c.sizeLabel,subtotalLabel:c.subtotalLabel,upsellProducts:c.upsellProducts,upsellsAddLabel:c.upsellsAddLabel};Ie({components:{CartDrawer:_n},data(){try{C.upsellProducts=JSON.parse(C.upsellProducts||"[]")}catch($){Y("[Allbirds section] - Cart Drawer Section - init - Error parsing upsellProducts",{props:C},$)}return{props:C}},name:"CartDrawerApp",template:'<cart-drawer v-bind="props" />'}).mount(o)}}document.addEventListener("DOMContentLoaded",()=>{new Cn});
//# sourceMappingURL=/cdn/shop/t/2799/assets/cart-drawer-section.js.map
