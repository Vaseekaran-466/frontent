import{e as x}from"./shopify.js";import{B as D,g as s,S as F}from"./base-section.js";import{S as $}from"./swiper-core.js";import{N as B}from"./navigation.js";import{c as V,r as v,o as k,a as G,w as H,l as _}from"./vue.esm-bundler.js";import{u as z}from"./use-viewport-size.js";import{A as a}from"./animations.js";import{h as X}from"./analytics-data.js";import"./create-element-if-not-defined.js";import"./rudderstack-client.js";import"./cookies.js";import"./validator.js";const W={breakpoints:{0:{slidesPerView:1.3},768:{slidesPerView:2}},centeredSlides:!0,loop:!0,modules:[B],navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},roundLengths:!0,speed:400,updateOnWindowResize:!0},m="large-product-carousel",y={PRODUCT_IMAGE_CONTAINER:"[data-product-image-container]",PRODUCT_INFO_CONTAINER:"[data-product-info-container]"};class Y extends D{constructor(){super(`[data-section-type="${m}"]`)}init(n){const t=n.container,c=this;V({name:"LargeProductCarouselSection",setup(){const i=v(null),C=v(null),O=v({mensUrl:"",price:"",title:"",womensUrl:""}),u=v(null),{isMobile:S}=z(),I=()=>{if(!i.value)return;const e=i.value.slides[i.value.activeIndex];e&&(O.value={description:e.getAttribute("data-product-description"),mensUrl:e.getAttribute("data-product-mens-url"),price:e.getAttribute("data-product-price"),title:e.getAttribute("data-product-title"),womensUrl:e.getAttribute("data-product-womens-url")})},L=async()=>{if(!i.value)return;const e=t.querySelectorAll(y.PRODUCT_INFO_CONTAINER);e.length>0&&await s.to(e,a.CAROUSEL_FADE_OUT),I(),await _(),e.length>0&&await s.to(e,a.CAROUSEL_FADE_IN)},T=()=>{const e=t.querySelector(`[data-${m}-swiper]`),o=e.querySelector(".swiper-button-prev"),r=e.querySelector(".swiper-button-next"),p=d=>{const{height:l,left:A,top:w,width:P}=e.getBoundingClientRect(),E=d.clientX-A,f=d.clientY-w,R=.2,U=.75,M=f<l*R,b=f>l*U,q=P/2;M||b?(o.style.opacity=0,r.style.opacity=0):E<q?(o.style.left=`${E}px`,o.style.top=`${f}px`,o.style.opacity=1,r.style.opacity=0):(r.style.left=`${E}px`,r.style.top=`${f}px`,r.style.opacity=1,o.style.opacity=0)},g=()=>{o.style.opacity=0,r.style.opacity=0};return t.addEventListener("mousemove",p),t.addEventListener("mouseleave",g),{handleMouseLeave:g,handleMouseMove:p}},N=e=>{e&&(t.removeEventListener("mousemove",e.handleMouseMove),t.removeEventListener("mouseleave",e.handleMouseLeave))},h=async e=>{C.value=e;const o=t.querySelectorAll(y.PRODUCT_IMAGE_CONTAINER),r=t.querySelectorAll(y.PRODUCT_INFO_CONTAINER);await Promise.all([o.length>0?s.to(o,a.CAROUSEL_FADE_OUT):Promise.resolve(),r.length>0?s.to(r,a.CAROUSEL_FADE_OUT):Promise.resolve()]);const p=t.querySelector(`[data-${m}-block-id="${e}"]`);if(!p)return;const g=p.querySelectorAll(".swiper-slide");i.value&&i.value.destroy();const d=t.querySelector(`[data-${m}-swiper]`),l=d.querySelector(".swiper-wrapper");l.innerHTML="",Array.from(g).forEach(w=>{l.appendChild(w.cloneNode(!0))});const A=l.querySelectorAll(y.PRODUCT_IMAGE_CONTAINER);i.value=new $(d,W),I(),await _(),await Promise.all([A.length>0?s.to(A,a.CAROUSEL_FADE_IN):Promise.resolve(),r.length>0?s.to(r,a.CAROUSEL_FADE_IN):Promise.resolve()]),i.value.on("slideChange",L)};return k(async()=>{const e=t.getAttribute("data-initial-category-id");try{e&&await h(e)}catch(o){x("[Allbirds section] - Large Product Carousel - onMounted - Error initializing carousel",{error:o},o)}S.value||(u.value=T()),c.isHomePageTemplate()&&X({sectionName:m})}),G(()=>{N(u.value)}),H(S,e=>{e?(N(u.value),u.value=null):u.value=T()}),{activeCategory:C,activeProduct:O,handleCategorySwitch:h}}}).mount(t)}setupInViewAnimation(n){if(n.animation)n.animation.paused(!1),F.refresh();else{const t=this.setupAnimation(n,()=>this.setupInViewAnimationTimeline(n));t&&t.scrollTrigger&&(n.scrollTrigger=t.scrollTrigger)}}setupInViewAnimationTimeline(n){const t=n.container;if(!t)return null;const c=s.timeline({paused:!0,scrollTrigger:{...this.getInViewAnimationOptions(),trigger:t}});return c?(c.fromTo(t,{opacity:0},a.FADE_IN,0),c):null}}document.addEventListener("DOMContentLoaded",()=>{new Y});
//# sourceMappingURL=large-product-carousel.js.map
